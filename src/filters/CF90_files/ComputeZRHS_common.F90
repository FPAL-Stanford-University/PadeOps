        select case (this%periodic)
        case (.TRUE.)
                RHS(:,:,         1) = a90 * ( f(:,:,         1) )                     &
                                    + b90 * ( f(:,:,         2) + f(:,:,    this%n) ) &
                                    + c90 * ( f(:,:,         3) + f(:,:,  this%n-1) ) &
                                    + d90 * ( f(:,:,         4) + f(:,:,  this%n-2) ) &
                                    + e90 * ( f(:,:,         5) + f(:,:,  this%n-3) )
                RHS(:,:,         2) = a90 * ( f(:,:,         2) )                     &
                                    + b90 * ( f(:,:,         3) + f(:,:,         1) ) &
                                    + c90 * ( f(:,:,         4) + f(:,:,    this%n) ) &
                                    + d90 * ( f(:,:,         5) + f(:,:,  this%n-1) ) &
                                    + e90 * ( f(:,:,         6) + f(:,:,  this%n-2) )
                RHS(:,:,         3) = a90 * ( f(:,:,         3) )                     &
                                    + b90 * ( f(:,:,         4) + f(:,:,         2) ) &
                                    + c90 * ( f(:,:,         5) + f(:,:,         1) ) &
                                    + d90 * ( f(:,:,         6) + f(:,:,    this%n) ) &
                                    + e90 * ( f(:,:,         7) + f(:,:,  this%n-1) )
                RHS(:,:,         4) = a90 * ( f(:,:,         4) )                     &
                                    + b90 * ( f(:,:,         5) + f(:,:,         3) ) &
                                    + c90 * ( f(:,:,         6) + f(:,:,         2) ) &
                                    + d90 * ( f(:,:,         7) + f(:,:,         1) ) &
                                    + e90 * ( f(:,:,         8) + f(:,:,    this%n) )
                RHS(:,:,5:this%n-4) = a90 * ( f(:,:,5:this%n-4) )                     &
                                    + b90 * ( f(:,:,6:this%n-3) + f(:,:,4:this%n-5) ) &
                                    + c90 * ( f(:,:,7:this%n-2) + f(:,:,3:this%n-6) ) &
                                    + d90 * ( f(:,:,8:this%n-1) + f(:,:,2:this%n-7) ) &
                                    + e90 * ( f(:,:,9:this%n  ) + f(:,:,1:this%n-8) )
                RHS(:,:,  this%n-3) = a90 * ( f(:,:,  this%n-3) )                     &
                                    + b90 * ( f(:,:,  this%n-2) + f(:,:,  this%n-4) ) &
                                    + c90 * ( f(:,:,  this%n-1) + f(:,:,  this%n-5) ) &
                                    + d90 * ( f(:,:,    this%n) + f(:,:,  this%n-6) ) &
                                    + e90 * ( f(:,:,         1) + f(:,:,  this%n-7) )
                RHS(:,:,  this%n-2) = a90 * ( f(:,:,  this%n-2) )                     &
                                    + b90 * ( f(:,:,  this%n-1) + f(:,:,  this%n-3) ) &
                                    + c90 * ( f(:,:,    this%n) + f(:,:,  this%n-4) ) &
                                    + d90 * ( f(:,:,         1) + f(:,:,  this%n-5) ) &
                                    + e90 * ( f(:,:,         2) + f(:,:,  this%n-6) )
                RHS(:,:,  this%n-1) = a90 * ( f(:,:,  this%n-1) )                     &
                                    + b90 * ( f(:,:,    this%n) + f(:,:,  this%n-2) ) &
                                    + c90 * ( f(:,:,         1) + f(:,:,  this%n-3) ) &
                                    + d90 * ( f(:,:,         2) + f(:,:,  this%n-4) ) &
                                    + e90 * ( f(:,:,         3) + f(:,:,  this%n-5) )
                RHS(:,:,    this%n) = a90 * ( f(:,:,    this%n) )                     &
                                    + b90 * ( f(:,:,         1) + f(:,:,  this%n-1) ) &
                                    + c90 * ( f(:,:,         2) + f(:,:,  this%n-2) ) &
                                    + d90 * ( f(:,:,         3) + f(:,:,  this%n-3) ) &
                                    + e90 * ( f(:,:,         4) + f(:,:,  this%n-4) )
        case (.FALSE.)
                    
            select case(bc1)
            case(0)
                RHS(:,:,         1) =    one * ( f(:,:,         1) )                     

                RHS(:,:,         2) = b2_a90 * ( f(:,:,         2) )                     &
                                    + b2_b90 * ( f(:,:,         3) + f(:,:,         1) ) 
                
                RHS(:,:,         3) = b3_a90 * ( f(:,:,         3) )                     &
                                    + b3_b90 * ( f(:,:,         4) + f(:,:,         2) ) &
                                    + b3_c90 * ( f(:,:,         5) + f(:,:,         1) )

                RHS(:,:,         4) = b4_a90 * ( f(:,:,         4) )                     &
                                    + b4_b90 * ( f(:,:,         5) + f(:,:,         3) ) &
                                    + b4_c90 * ( f(:,:,         6) + f(:,:,         2) ) &
                                    + b4_d90 * ( f(:,:,         7) + f(:,:,         1) ) 
            case(1)
                RHS(:,:,1) =    a90 * ( f(:,:,1) )            &
                           +    b90 * ( f(:,:,2) + f(:,:,2) ) &
                           +    c90 * ( f(:,:,3) + f(:,:,3) ) &
                           +    d90 * ( f(:,:,4) + f(:,:,4) ) &
                           +    e90 * ( f(:,:,5) + f(:,:,5) )
                RHS(:,:,2) =    a90 * ( f(:,:,2) )            &
                           +    b90 * ( f(:,:,3) + f(:,:,1) ) &
                           +    c90 * ( f(:,:,4) + f(:,:,2) ) &
                           +    d90 * ( f(:,:,5) + f(:,:,3) ) &
                           +    e90 * ( f(:,:,6) + f(:,:,4) )
                RHS(:,:,3) =    a90 * ( f(:,:,3) )            &
                           +    b90 * ( f(:,:,4) + f(:,:,2) ) &
                           +    c90 * ( f(:,:,5) + f(:,:,1) ) &
                           +    d90 * ( f(:,:,6) + f(:,:,2) ) &
                           +    e90 * ( f(:,:,7) + f(:,:,3) )
                RHS(:,:,4) =    a90 * ( f(:,:,4) )            &
                           +    b90 * ( f(:,:,5) + f(:,:,3) ) &
                           +    c90 * ( f(:,:,6) + f(:,:,2) ) &
                           +    d90 * ( f(:,:,7) + f(:,:,1) ) &
                           +    e90 * ( f(:,:,8) + f(:,:,2) )
            case(-1)    
                RHS(:,:,1) =    a90 * ( f(:,:,1) )            &
                           +    b90 * ( f(:,:,2) - f(:,:,2) ) &
                           +    c90 * ( f(:,:,3) - f(:,:,3) ) &
                           +    d90 * ( f(:,:,4) - f(:,:,4) ) &
                           +    e90 * ( f(:,:,5) - f(:,:,5) )
                RHS(:,:,2) =    a90 * ( f(:,:,2) )            &
                           +    b90 * ( f(:,:,3) + f(:,:,1) ) &
                           +    c90 * ( f(:,:,4) - f(:,:,2) ) &
                           +    d90 * ( f(:,:,5) - f(:,:,3) ) &
                           +    e90 * ( f(:,:,6) - f(:,:,4) )
                RHS(:,:,3) =    a90 * ( f(:,:,3) )            &
                           +    b90 * ( f(:,:,4) + f(:,:,2) ) &
                           +    c90 * ( f(:,:,5) + f(:,:,1) ) &
                           +    d90 * ( f(:,:,6) - f(:,:,2) ) &
                           +    e90 * ( f(:,:,7) - f(:,:,3) )
                RHS(:,:,4) =    a90 * ( f(:,:,4) )            &
                           +    b90 * ( f(:,:,5) + f(:,:,3) ) &
                           +    c90 * ( f(:,:,6) + f(:,:,2) ) &
                           +    d90 * ( f(:,:,7) + f(:,:,1) ) &
                           +    e90 * ( f(:,:,8) - f(:,:,2) )
            end select

            RHS(:,:,5:this%n-4) =    a90 * ( f(:,:,5:this%n-4) )                     &
                                +    b90 * ( f(:,:,6:this%n-3) + f(:,:,4:this%n-5) ) &
                                +    c90 * ( f(:,:,7:this%n-2) + f(:,:,3:this%n-6) ) &
                                +    d90 * ( f(:,:,8:this%n-1) + f(:,:,2:this%n-7) ) &
                                +    e90 * ( f(:,:,9:this%n  ) + f(:,:,1:this%n-8) )

            select case(bcn)
            case(0)
                RHS(:,:,  this%n-3) = b4_a90 * ( f(:,:,  this%n-3) )                     &
                                    + b4_b90 * ( f(:,:,  this%n-2) + f(:,:,  this%n-4) ) &
                                    + b4_c90 * ( f(:,:,  this%n-1) + f(:,:,  this%n-5) ) &
                                    + b4_d90 * ( f(:,:,    this%n) + f(:,:,  this%n-6) ) 

                RHS(:,:,  this%n-2) = b3_a90 * ( f(:,:,  this%n-2) )                     &
                                    + b3_b90 * ( f(:,:,  this%n-1) + f(:,:,  this%n-3) ) &
                                    + b3_c90 * ( f(:,:,    this%n) + f(:,:,  this%n-4) ) 

                RHS(:,:,  this%n-1) = b2_a90 * ( f(:,:,  this%n-1) )                     &
                                    + b2_b90 * ( f(:,:,    this%n) + f(:,:,  this%n-2) ) 

                RHS(:,:,    this%n) =    one * ( f(:,:,    this%n) )                     
            case(1)
                RHS(:,:,this%n-3) =    a90 * ( f(:,:,this%n-3) )                   &
                                  +    b90 * ( f(:,:,this%n-2) + f(:,:,this%n-4) ) &
                                  +    c90 * ( f(:,:,this%n-1) + f(:,:,this%n-5) ) &
                                  +    d90 * ( f(:,:,this%n  ) + f(:,:,this%n-6) ) &
                                  +    e90 * ( f(:,:,this%n-1) + f(:,:,this%n-7) )
                RHS(:,:,this%n-2) =    a90 * ( f(:,:,this%n-2) )                   &
                                  +    b90 * ( f(:,:,this%n-1) + f(:,:,this%n-3) ) &
                                  +    c90 * ( f(:,:,this%n  ) + f(:,:,this%n-4) ) &
                                  +    d90 * ( f(:,:,this%n-1) + f(:,:,this%n-5) ) &
                                  +    e90 * ( f(:,:,this%n-2) + f(:,:,this%n-6) )
                RHS(:,:,this%n-1) =    a90 * ( f(:,:,this%n-1) )                   &
                                  +    b90 * ( f(:,:,this%n  ) + f(:,:,this%n-2) ) &
                                  +    c90 * ( f(:,:,this%n-1) + f(:,:,this%n-3) ) &
                                  +    d90 * ( f(:,:,this%n-2) + f(:,:,this%n-4) ) &
                                  +    e90 * ( f(:,:,this%n-3) + f(:,:,this%n-5) )
                RHS(:,:,this%n  ) =    a90 * ( f(:,:,this%n  ) )                   &
                                  +    b90 * ( f(:,:,this%n-1) + f(:,:,this%n-1) ) &
                                  +    c90 * ( f(:,:,this%n-2) + f(:,:,this%n-2) ) &
                                  +    d90 * ( f(:,:,this%n-3) + f(:,:,this%n-3) ) &
                                  +    e90 * ( f(:,:,this%n-4) + f(:,:,this%n-4) )
            case(-1)    
                RHS(:,:,this%n-3) =    a90 * ( f(:,:,this%n-3) )                   &
                                  +    b90 * ( f(:,:,this%n-2) + f(:,:,this%n-4) ) &
                                  +    c90 * ( f(:,:,this%n-1) + f(:,:,this%n-5) ) &
                                  +    d90 * ( f(:,:,this%n  ) + f(:,:,this%n-6) ) &
                                  +    e90 * (-f(:,:,this%n-1) + f(:,:,this%n-7) )
                RHS(:,:,this%n-2) =    a90 * ( f(:,:,this%n-2) )                   &
                                  +    b90 * ( f(:,:,this%n-1) + f(:,:,this%n-3) ) &
                                  +    c90 * ( f(:,:,this%n  ) + f(:,:,this%n-4) ) &
                                  +    d90 * (-f(:,:,this%n-1) + f(:,:,this%n-5) ) &
                                  +    e90 * (-f(:,:,this%n-2) + f(:,:,this%n-6) )
                RHS(:,:,this%n-1) =    a90 * ( f(:,:,this%n-1) )                   &
                                  +    b90 * ( f(:,:,this%n  ) + f(:,:,this%n-2) ) &
                                  +    c90 * (-f(:,:,this%n-1) + f(:,:,this%n-3) ) &
                                  +    d90 * (-f(:,:,this%n-2) + f(:,:,this%n-4) ) &
                                  +    e90 * (-f(:,:,this%n-3) + f(:,:,this%n-5) )
                RHS(:,:,this%n  ) =    a90 * ( f(:,:,this%n  ) )                   &
                                  +    b90 * (-f(:,:,this%n-1) + f(:,:,this%n-1) ) &
                                  +    c90 * (-f(:,:,this%n-2) + f(:,:,this%n-2) ) &
                                  +    d90 * (-f(:,:,this%n-3) + f(:,:,this%n-3) ) &
                                  +    e90 * (-f(:,:,this%n-4) + f(:,:,this%n-4) )
            end select

        end select
