  select case (this%periodic)
  case (.TRUE.)
     RHS(:,:,         1) = a0_d15 * ( f(:,:,         1) )      &
          + a1_d15 * ( f(:,:,         2) + f(:,:,    this%n) ) &
          + a2_d15 * ( f(:,:,         3) + f(:,:,  this%n-1) ) &
          + a3_d15 * ( f(:,:,         4) + f(:,:,  this%n-2) ) &
          + a4_d15 * ( f(:,:,         5) + f(:,:,  this%n-3) ) &
          + a5_d15 * ( f(:,:,         6) + f(:,:,  this%n-4) ) &
          + a6_d15 * ( f(:,:,         7) + f(:,:,  this%n-5) ) &
          + a7_d15 * ( f(:,:,         8) + f(:,:,  this%n-6) )
     RHS(:,:,         2) = a0_d15 * ( f(:,:,         2) )      &
          + a1_d15 * ( f(:,:,         3) + f(:,:,         1) ) &
          + a2_d15 * ( f(:,:,         4) + f(:,:,    this%n) ) &
          + a3_d15 * ( f(:,:,         5) + f(:,:,  this%n-1) ) &
          + a4_d15 * ( f(:,:,         6) + f(:,:,  this%n-2) ) &
          + a5_d15 * ( f(:,:,         7) + f(:,:,  this%n-3) ) &
          + a6_d15 * ( f(:,:,         8) + f(:,:,  this%n-4) ) &
          + a7_d15 * ( f(:,:,         9) + f(:,:,  this%n-5) )
     RHS(:,:,         3) = a0_d15 * ( f(:,:,         3) )      &
          + a1_d15 * ( f(:,:,         4) + f(:,:,         2) ) &
          + a2_d15 * ( f(:,:,         5) + f(:,:,         1) ) &
          + a3_d15 * ( f(:,:,         6) + f(:,:,    this%n) ) &
          + a4_d15 * ( f(:,:,         7) + f(:,:,  this%n-1) ) &
          + a5_d15 * ( f(:,:,         8) + f(:,:,  this%n-2) ) &
          + a6_d15 * ( f(:,:,         9) + f(:,:,  this%n-3) ) &
          + a7_d15 * ( f(:,:,        10) + f(:,:,  this%n-4) )
     RHS(:,:,         4) = a0_d15 * ( f(:,:,         4) )      &
          + a1_d15 * ( f(:,:,         5) + f(:,:,         3) ) &
          + a2_d15 * ( f(:,:,         6) + f(:,:,         2) ) &
          + a3_d15 * ( f(:,:,         7) + f(:,:,         1) ) &
          + a4_d15 * ( f(:,:,         8) + f(:,:,    this%n) ) &
          + a5_d15 * ( f(:,:,         9) + f(:,:,  this%n-1) ) &
          + a6_d15 * ( f(:,:,        10) + f(:,:,  this%n-2) ) &
          + a7_d15 * ( f(:,:,        11) + f(:,:,  this%n-3) )
     RHS(:,:,         5) = a0_d15 * ( f(:,:,         5) )      &
          + a1_d15 * ( f(:,:,         6) + f(:,:,         4) ) &
          + a2_d15 * ( f(:,:,         7) + f(:,:,         3) ) &
          + a3_d15 * ( f(:,:,         8) + f(:,:,         2) ) &
          + a4_d15 * ( f(:,:,         9) + f(:,:,         1) ) &
          + a5_d15 * ( f(:,:,        10) + f(:,:,    this%n) ) &
          + a6_d15 * ( f(:,:,        11) + f(:,:,  this%n-1) ) &
          + a7_d15 * ( f(:,:,        12) + f(:,:,  this%n-2) )
     RHS(:,:,         6) = a0_d15 * ( f(:,:,         6) )      &
          + a1_d15 * ( f(:,:,         7) + f(:,:,         5) ) &
          + a2_d15 * ( f(:,:,         8) + f(:,:,         4) ) &
          + a3_d15 * ( f(:,:,         9) + f(:,:,         3) ) &
          + a4_d15 * ( f(:,:,        10) + f(:,:,         2) ) &
          + a5_d15 * ( f(:,:,        11) + f(:,:,         1) ) &
          + a6_d15 * ( f(:,:,        12) + f(:,:,    this%n) ) &
          + a7_d15 * ( f(:,:,        13) + f(:,:,  this%n-1) )
     RHS(:,:,         7) = a0_d15 * ( f(:,:,         7) )      &
          + a1_d15 * ( f(:,:,         8) + f(:,:,         6) ) &
          + a2_d15 * ( f(:,:,         9) + f(:,:,         5) ) &
          + a3_d15 * ( f(:,:,        10) + f(:,:,         4) ) &
          + a4_d15 * ( f(:,:,        11) + f(:,:,         3) ) &
          + a5_d15 * ( f(:,:,        12) + f(:,:,         2) ) &
          + a6_d15 * ( f(:,:,        13) + f(:,:,         1) ) &
          + a7_d15 * ( f(:,:,        14) + f(:,:,    this%n) )
     RHS(:,:,8:this%n-7) = a0_d15 * ( f(:,:,8 :this%n-7) )       &
          + a1_d15 * ( f(:,:,9 :this%n-6) + f(:,:,7:this%n-8 ) ) &
          + a2_d15 * ( f(:,:,10:this%n-5) + f(:,:,6:this%n-9 ) ) &
          + a3_d15 * ( f(:,:,11:this%n-4) + f(:,:,5:this%n-10) ) &
          + a4_d15 * ( f(:,:,12:this%n-3) + f(:,:,4:this%n-11) ) &
          + a5_d15 * ( f(:,:,13:this%n-2) + f(:,:,3:this%n-12) ) &
          + a6_d15 * ( f(:,:,14:this%n-1) + f(:,:,2:this%n-13) ) &
          + a7_d15 * ( f(:,:,15:this%n  ) + f(:,:,1:this%n-14) )
     RHS(:,:,  this%n-6) = a0_d15 * ( f(:,:,  this%n-6) )       &
          + a1_d15 * ( f(:,:,  this%n-5) + f(:,:,  this%n-7 ) ) &
          + a2_d15 * ( f(:,:,  this%n-4) + f(:,:,  this%n-8 ) ) &
          + a3_d15 * ( f(:,:,  this%n-3) + f(:,:,  this%n-9 ) ) &
          + a4_d15 * ( f(:,:,  this%n-2) + f(:,:,  this%n-10) ) &
          + a5_d15 * ( f(:,:,  this%n-1) + f(:,:,  this%n-11) ) &
          + a6_d15 * ( f(:,:,    this%n) + f(:,:,  this%n-12) ) &
          + a7_d15 * ( f(:,:,         1) + f(:,:,  this%n-13) )
     RHS(:,:,  this%n-5) = a0_d15 * ( f(:,:,  this%n-5) )       &
          + a1_d15 * ( f(:,:,  this%n-4) + f(:,:,  this%n-6 ) ) &
          + a2_d15 * ( f(:,:,  this%n-3) + f(:,:,  this%n-7 ) ) &
          + a3_d15 * ( f(:,:,  this%n-2) + f(:,:,  this%n-8 ) ) &
          + a4_d15 * ( f(:,:,  this%n-1) + f(:,:,  this%n-9 ) ) &
          + a5_d15 * ( f(:,:,    this%n) + f(:,:,  this%n-10) ) &
          + a6_d15 * ( f(:,:,         1) + f(:,:,  this%n-11) ) &
          + a7_d15 * ( f(:,:,         2) + f(:,:,  this%n-12) )
     RHS(:,:,  this%n-4) = a0_d15 * ( f(:,:,  this%n-4) )       &
          + a1_d15 * ( f(:,:,  this%n-3) + f(:,:,  this%n-5 ) ) &
          + a2_d15 * ( f(:,:,  this%n-2) + f(:,:,  this%n-6 ) ) &
          + a3_d15 * ( f(:,:,  this%n-1) + f(:,:,  this%n-7 ) ) &
          + a4_d15 * ( f(:,:,    this%n) + f(:,:,  this%n-8 ) ) &
          + a5_d15 * ( f(:,:,         1) + f(:,:,  this%n-9 ) ) &
          + a6_d15 * ( f(:,:,         2) + f(:,:,  this%n-10) ) &
          + a7_d15 * ( f(:,:,         3) + f(:,:,  this%n-11) )
     RHS(:,:,  this%n-3) = a0_d15 * ( f(:,:,  this%n-3) )       &
          + a1_d15 * ( f(:,:,  this%n-2) + f(:,:,  this%n-4 ) ) &
          + a2_d15 * ( f(:,:,  this%n-1) + f(:,:,  this%n-5 ) ) &
          + a3_d15 * ( f(:,:,    this%n) + f(:,:,  this%n-6 ) ) &
          + a4_d15 * ( f(:,:,         1) + f(:,:,  this%n-7 ) ) &
          + a5_d15 * ( f(:,:,         2) + f(:,:,  this%n-8 ) ) &
          + a6_d15 * ( f(:,:,         3) + f(:,:,  this%n-9 ) ) &
          + a7_d15 * ( f(:,:,         4) + f(:,:,  this%n-10) )
     RHS(:,:,  this%n-2) = a0_d15 * ( f(:,:,  this%n-2) )       &
          + a1_d15 * ( f(:,:,  this%n-1) + f(:,:,  this%n-3 ) ) &
          + a2_d15 * ( f(:,:,    this%n) + f(:,:,  this%n-4 ) ) &
          + a3_d15 * ( f(:,:,         1) + f(:,:,  this%n-5 ) ) &
          + a4_d15 * ( f(:,:,         2) + f(:,:,  this%n-6 ) ) &
          + a5_d15 * ( f(:,:,         3) + f(:,:,  this%n-7 ) ) &
          + a6_d15 * ( f(:,:,         4) + f(:,:,  this%n-8 ) ) &
          + a7_d15 * ( f(:,:,         5) + f(:,:,  this%n-9 ) )
     RHS(:,:,  this%n-1) = a0_d15 * ( f(:,:,  this%n-1) )       &
          + a1_d15 * ( f(:,:,    this%n) + f(:,:,  this%n-2 ) ) &
          + a2_d15 * ( f(:,:,         1) + f(:,:,  this%n-3 ) ) &
          + a3_d15 * ( f(:,:,         2) + f(:,:,  this%n-4 ) ) &
          + a4_d15 * ( f(:,:,         3) + f(:,:,  this%n-5 ) ) &
          + a5_d15 * ( f(:,:,         4) + f(:,:,  this%n-6 ) ) &
          + a6_d15 * ( f(:,:,         5) + f(:,:,  this%n-7 ) ) &
          + a7_d15 * ( f(:,:,         6) + f(:,:,  this%n-8 ) )
     RHS(:,:,  this%n  ) = a0_d15 * ( f(:,:,    this%n) )       &
          + a1_d15 * ( f(:,:,         1) + f(:,:,  this%n-1 ) ) &
          + a2_d15 * ( f(:,:,         2) + f(:,:,  this%n-2 ) ) &
          + a3_d15 * ( f(:,:,         3) + f(:,:,  this%n-3 ) ) &
          + a4_d15 * ( f(:,:,         4) + f(:,:,  this%n-4 ) ) &
          + a5_d15 * ( f(:,:,         5) + f(:,:,  this%n-5 ) ) &
          + a6_d15 * ( f(:,:,         6) + f(:,:,  this%n-6 ) ) &
          + a7_d15 * ( f(:,:,         7) + f(:,:,  this%n-7 ) )
  case (.FALSE.)


     ! interior points
     RHS(:,:,8:this%n-7) = a0_d15 * ( f(:,:,8:this%n-7) )        &
          + a1_d15 * ( f(:,:,9 :this%n-6) + f(:,:,7:this%n-8 ) ) &
          + a2_d15 * ( f(:,:,10:this%n-5) + f(:,:,6:this%n-9 ) ) &
          + a3_d15 * ( f(:,:,11:this%n-4) + f(:,:,5:this%n-10) ) &
          + a4_d15 * ( f(:,:,12:this%n-3) + f(:,:,4:this%n-11) ) &
          + a5_d15 * ( f(:,:,13:this%n-2) + f(:,:,3:this%n-12) ) &
          + a6_d15 * ( f(:,:,14:this%n-1) + f(:,:,2:this%n-13) ) &
          + a7_d15 * ( f(:,:,15:this%n  ) + f(:,:,1:this%n-14) )

     ! bc 1
     select case(bc1)
     case(0)

        RHS(:,:,         1) = b1_a0_d15 * ( f(:,:,         1) )                
        RHS(:,:,         2) = b2_a0_d15 * ( f(:,:,         2) )                &
             + b2_a1_d15 * f(:,:,         3 ) + b2_b1_d15 * f(:,:,         1)  &
             + b2_a2_d15 * f(:,:,         4 )                                  &
             + b2_a3_d15 * f(:,:,         5 )                                  &
             + b2_a4_d15 * f(:,:,         6 )                                  &
             + b2_a5_d15 * f(:,:,         7 )                                  &
             + b2_a6_d15 * f(:,:,         8 )                                  &
             + b2_a7_d15 * f(:,:,         9 )                     
        RHS(:,:,         3) = b3_a0_d15 * ( f(:,:,         3) )                &
             + b3_a1_d15 * f(:,:,         4 ) + b3_b1_d15 * f(:,:,         2)  &
             + b3_a2_d15 * f(:,:,         5 ) + b3_b2_d15 * f(:,:,         1)  &
             + b3_a3_d15 * f(:,:,         6 )                                  &
             + b3_a4_d15 * f(:,:,         7 )                                  &
             + b3_a5_d15 * f(:,:,         8 )                                  &
             + b3_a6_d15 * f(:,:,         9 )                                  &
             + b3_a7_d15 * f(:,:,         10)                     
        RHS(:,:,         4) = b4_a0_d15 * ( f(:,:,         4) )                &
             + b4_a1_d15 * f(:,:,         5 ) + b4_b1_d15 * f(:,:,         3)  &
             + b4_a2_d15 * f(:,:,         6 ) + b4_b2_d15 * f(:,:,         2)  &
             + b4_a3_d15 * f(:,:,         7 ) + b4_b3_d15 * f(:,:,         1)  &
             + b4_a4_d15 * f(:,:,         8 )                                  &
             + b4_a5_d15 * f(:,:,         9 )                                  &
             + b4_a6_d15 * f(:,:,         10)                                  &
             + b4_a7_d15 * f(:,:,         11)                     
        RHS(:,:,         5) = b5_a0_d15 * ( f(:,:,         5) )                &
             + b5_a1_d15 * f(:,:,         6 ) + b5_b1_d15 * f(:,:,         4)  &
             + b5_a2_d15 * f(:,:,         7 ) + b5_b2_d15 * f(:,:,         3)  &
             + b5_a3_d15 * f(:,:,         8 ) + b5_b3_d15 * f(:,:,         2)  &
             + b5_a4_d15 * f(:,:,         9 ) + b5_b4_d15 * f(:,:,         1)  &
             + b5_a5_d15 * f(:,:,         10)                                  &
             + b5_a6_d15 * f(:,:,         11)                                  &
             + b5_a7_d15 * f(:,:,         12)                     
        RHS(:,:,         6) = b6_a0_d15 * ( f(:,:,         6) )                &
             + b6_a1_d15 * f(:,:,         7 ) + b6_b1_d15 * f(:,:,         5)  &
             + b6_a2_d15 * f(:,:,         8 ) + b6_b2_d15 * f(:,:,         4)  &
             + b6_a3_d15 * f(:,:,         9 ) + b6_b3_d15 * f(:,:,         3)  &
             + b6_a4_d15 * f(:,:,         10) + b6_b4_d15 * f(:,:,         2)  &
             + b6_a5_d15 * f(:,:,         11) + b6_b5_d15 * f(:,:,         1)  &
             + b6_a6_d15 * f(:,:,         12)                                  &
             + b6_a7_d15 * f(:,:,         13)                     
        RHS(:,:,         7) = b7_a0_d15 * ( f(:,:,         7) )                &
             + b7_a1_d15 * f(:,:,         8 ) + b7_b1_d15 * f(:,:,         6)  &
             + b7_a2_d15 * f(:,:,         9 ) + b7_b2_d15 * f(:,:,         5)  &
             + b7_a3_d15 * f(:,:,         10) + b7_b3_d15 * f(:,:,         4)  &
             + b7_a4_d15 * f(:,:,         11) + b7_b4_d15 * f(:,:,         3)  &
             + b7_a5_d15 * f(:,:,         12) + b7_b5_d15 * f(:,:,         2)  &
             + b7_a6_d15 * f(:,:,         13) + b7_b6_d15 * f(:,:,         1)  &
             + b7_a7_d15 * f(:,:,         14)                     

     case(1)
        RHS(:,:,         1) = a0_d15 * ( f(:,:,         1) )       &
             + a1_d15 * ( f(:,:,         2 ) + f(:,:,         2) ) &
             + a2_d15 * ( f(:,:,         3 ) + f(:,:,         3) ) &
             + a3_d15 * ( f(:,:,         4 ) + f(:,:,         4) ) &
             + a4_d15 * ( f(:,:,         5 ) + f(:,:,         5) ) &
             + a5_d15 * ( f(:,:,         6 ) + f(:,:,         6) ) &
             + a6_d15 * ( f(:,:,         7 ) + f(:,:,         7) ) &
             + a7_d15 * ( f(:,:,         8 ) + f(:,:,         8) )
        RHS(:,:,         2) = a0_d15 * ( f(:,:,         2) )       &
             + a1_d15 * ( f(:,:,         3 ) + f(:,:,         1) ) &
             + a2_d15 * ( f(:,:,         4 ) + f(:,:,         2) ) &
             + a3_d15 * ( f(:,:,         5 ) + f(:,:,         3) ) &
             + a4_d15 * ( f(:,:,         6 ) + f(:,:,         4) ) &
             + a5_d15 * ( f(:,:,         7 ) + f(:,:,         5) ) &
             + a6_d15 * ( f(:,:,         8 ) + f(:,:,         6) ) &
             + a7_d15 * ( f(:,:,         9 ) + f(:,:,         7) )
        RHS(:,:,         3) = a0_d15 * ( f(:,:,         3) )       &
             + a1_d15 * ( f(:,:,         4 ) + f(:,:,         2) ) &
             + a2_d15 * ( f(:,:,         5 ) + f(:,:,         1) ) &
             + a3_d15 * ( f(:,:,         6 ) + f(:,:,         2) ) &
             + a4_d15 * ( f(:,:,         7 ) + f(:,:,         3) ) &
             + a5_d15 * ( f(:,:,         8 ) + f(:,:,         4) ) &
             + a6_d15 * ( f(:,:,         9 ) + f(:,:,         5) ) &
             + a7_d15 * ( f(:,:,         10) + f(:,:,         6) )
        RHS(:,:,         4) = a0_d15 * ( f(:,:,         4) )       &
             + a1_d15 * ( f(:,:,         5 ) + f(:,:,         3) ) &
             + a2_d15 * ( f(:,:,         6 ) + f(:,:,         2) ) &
             + a3_d15 * ( f(:,:,         7 ) + f(:,:,         1) ) &
             + a4_d15 * ( f(:,:,         8 ) + f(:,:,         2) ) &
             + a5_d15 * ( f(:,:,         9 ) + f(:,:,         3) ) &
             + a6_d15 * ( f(:,:,         10) + f(:,:,         4) ) &
             + a7_d15 * ( f(:,:,         11) + f(:,:,         5) )
        RHS(:,:,         5) = a0_d15 * ( f(:,:,         5) )       &
             + a1_d15 * ( f(:,:,         6 ) + f(:,:,         4) ) &
             + a2_d15 * ( f(:,:,         7 ) + f(:,:,         3) ) &
             + a3_d15 * ( f(:,:,         8 ) + f(:,:,         2) ) &
             + a4_d15 * ( f(:,:,         9 ) + f(:,:,         1) ) &
             + a5_d15 * ( f(:,:,         10) + f(:,:,         2) ) &
             + a6_d15 * ( f(:,:,         11) + f(:,:,         3) ) &
             + a7_d15 * ( f(:,:,         12) + f(:,:,         4) )
        RHS(:,:,         6) = a0_d15 * ( f(:,:,         6) )       &
             + a1_d15 * ( f(:,:,         7 ) + f(:,:,         5) ) &
             + a2_d15 * ( f(:,:,         8 ) + f(:,:,         4) ) &
             + a3_d15 * ( f(:,:,         9 ) + f(:,:,         3) ) &
             + a4_d15 * ( f(:,:,         10) + f(:,:,         2) ) &
             + a5_d15 * ( f(:,:,         11) + f(:,:,         1) ) &
             + a6_d15 * ( f(:,:,         12) + f(:,:,         2) ) &
             + a7_d15 * ( f(:,:,         13) + f(:,:,         3) )
        RHS(:,:,         7) = a0_d15 * ( f(:,:,         7) )       &
             + a1_d15 * ( f(:,:,         8 ) + f(:,:,         6) ) &
             + a2_d15 * ( f(:,:,         9 ) + f(:,:,         5) ) &
             + a3_d15 * ( f(:,:,         10) + f(:,:,         4) ) &
             + a4_d15 * ( f(:,:,         11) + f(:,:,         3) ) &
             + a5_d15 * ( f(:,:,         12) + f(:,:,         2) ) &
             + a6_d15 * ( f(:,:,         13) + f(:,:,         1) ) &
             + a7_d15 * ( f(:,:,         14) + f(:,:,         2) )

     case(-1)
        RHS(:,:,         1) = a0_d15 * ( f(:,:,         1) )       &
             + a1_d15 * ( f(:,:,         2 ) - f(:,:,         2) ) &
             + a2_d15 * ( f(:,:,         3 ) - f(:,:,         3) ) &
             + a3_d15 * ( f(:,:,         4 ) - f(:,:,         4) ) &
             + a4_d15 * ( f(:,:,         5 ) - f(:,:,         5) ) &
             + a5_d15 * ( f(:,:,         6 ) - f(:,:,         6) ) &
             + a6_d15 * ( f(:,:,         7 ) - f(:,:,         7) ) &
             + a7_d15 * ( f(:,:,         8 ) - f(:,:,         8) )
        RHS(:,:,         2) = a0_d15 * ( f(:,:,         2) )       &
             + a1_d15 * ( f(:,:,         3 ) + f(:,:,         1) ) &
             + a2_d15 * ( f(:,:,         4 ) - f(:,:,         2) ) &
             + a3_d15 * ( f(:,:,         5 ) - f(:,:,         3) ) &
             + a4_d15 * ( f(:,:,         6 ) - f(:,:,         4) ) &
             + a5_d15 * ( f(:,:,         7 ) - f(:,:,         5) ) &
             + a6_d15 * ( f(:,:,         8 ) - f(:,:,         6) ) &
             + a7_d15 * ( f(:,:,         9 ) - f(:,:,         7) )
        RHS(:,:,         3) = a0_d15 * ( f(:,:,         3) )       &
             + a1_d15 * ( f(:,:,         4 ) + f(:,:,         2) ) &
             + a2_d15 * ( f(:,:,         5 ) + f(:,:,         1) ) &
             + a3_d15 * ( f(:,:,         6 ) - f(:,:,         2) ) &
             + a4_d15 * ( f(:,:,         7 ) - f(:,:,         3) ) &
             + a5_d15 * ( f(:,:,         8 ) - f(:,:,         4) ) &
             + a6_d15 * ( f(:,:,         9 ) - f(:,:,         5) ) &
             + a7_d15 * ( f(:,:,         10) - f(:,:,         6) )
        RHS(:,:,         4) = a0_d15 * ( f(:,:,         4) )       &
             + a1_d15 * ( f(:,:,         5 ) + f(:,:,         3) ) &
             + a2_d15 * ( f(:,:,         6 ) + f(:,:,         2) ) &
             + a3_d15 * ( f(:,:,         7 ) + f(:,:,         1) ) &
             + a4_d15 * ( f(:,:,         8 ) - f(:,:,         2) ) &
             + a5_d15 * ( f(:,:,         9 ) - f(:,:,         3) ) &
             + a6_d15 * ( f(:,:,         10) - f(:,:,         4) ) &
             + a7_d15 * ( f(:,:,         11) - f(:,:,         5) )
        RHS(:,:,         5) = a0_d15 * ( f(:,:,         5) )       &
             + a1_d15 * ( f(:,:,         6 ) + f(:,:,         4) ) &
             + a2_d15 * ( f(:,:,         7 ) + f(:,:,         3) ) &
             + a3_d15 * ( f(:,:,         8 ) + f(:,:,         2) ) &
             + a4_d15 * ( f(:,:,         9 ) + f(:,:,         1) ) &
             + a5_d15 * ( f(:,:,         10) - f(:,:,         2) ) &
             + a6_d15 * ( f(:,:,         11) - f(:,:,         3) ) &
             + a7_d15 * ( f(:,:,         12) - f(:,:,         4) )
        RHS(:,:,         6) = a0_d15 * ( f(:,:,         6) )       &
             + a1_d15 * ( f(:,:,         7 ) + f(:,:,         5) ) &
             + a2_d15 * ( f(:,:,         8 ) + f(:,:,         4) ) &
             + a3_d15 * ( f(:,:,         9 ) + f(:,:,         3) ) &
             + a4_d15 * ( f(:,:,         10) + f(:,:,         2) ) &
             + a5_d15 * ( f(:,:,         11) + f(:,:,         1) ) &
             + a6_d15 * ( f(:,:,         12) - f(:,:,         2) ) &
             + a7_d15 * ( f(:,:,         13) - f(:,:,         3) )
        RHS(:,:,         7) = a0_d15 * ( f(:,:,         7) )       &
             + a1_d15 * ( f(:,:,         8 ) + f(:,:,         6) ) &
             + a2_d15 * ( f(:,:,         9 ) + f(:,:,         5) ) &
             + a3_d15 * ( f(:,:,         10) + f(:,:,         4) ) &
             + a4_d15 * ( f(:,:,         11) + f(:,:,         3) ) &
             + a5_d15 * ( f(:,:,         12) + f(:,:,         2) ) &
             + a6_d15 * ( f(:,:,         13) + f(:,:,         1) ) &
             + a7_d15 * ( f(:,:,         14) - f(:,:,         2) )

     end select

     ! bcn
     select case(bcn)
     case(0)
        RHS(:,:,  this%n-6) = a0_d15 * ( f(:,:,  this%n-6) )                    &
             + b7_b1_d15 * f(:,:,   this%n-5) + b7_a1_d15 * f(:,:,  this%n-7 )  &
             + b7_b2_d15 * f(:,:,   this%n-4) + b7_a2_d15 * f(:,:,  this%n-8 )  &
             + b7_b3_d15 * f(:,:,   this%n-3) + b7_a3_d15 * f(:,:,  this%n-9 )  &
             + b7_b4_d15 * f(:,:,   this%n-2) + b7_a4_d15 * f(:,:,  this%n-10)  &
             + b7_b5_d15 * f(:,:,   this%n-1) + b7_a5_d15 * f(:,:,  this%n-11)  &
             + b7_b6_d15 * f(:,:,   this%n  ) + b7_a6_d15 * f(:,:,  this%n-12)  &
                                              + b7_a7_d15 * f(:,:,  this%n-13) 
        RHS(:,:,  this%n-5) = a0_d15 * ( f(:,:,  this%n-5) )                    &
             + b6_b1_d15 * f(:,:,   this%n-4) + b6_a1_d15 * f(:,:,  this%n-6 )  &
             + b6_b2_d15 * f(:,:,   this%n-3) + b6_a2_d15 * f(:,:,  this%n-7 )  &
             + b6_b3_d15 * f(:,:,   this%n-2) + b6_a3_d15 * f(:,:,  this%n-8 )  &
             + b6_b4_d15 * f(:,:,   this%n-1) + b6_a4_d15 * f(:,:,  this%n-9 )  &
             + b6_b5_d15 * f(:,:,   this%n  ) + b6_a5_d15 * f(:,:,  this%n-10)  &
                                              + b6_a6_d15 * f(:,:,  this%n-11)  &
                                              + b6_a7_d15 * f(:,:,  this%n-12) 
        RHS(:,:,  this%n-4) = a0_d15 * ( f(:,:,  this%n-4) )                    &
             + b5_b1_d15 * f(:,:,   this%n-3) + b5_a1_d15 * f(:,:,  this%n-5 )  &
             + b5_b2_d15 * f(:,:,   this%n-2) + b5_a2_d15 * f(:,:,  this%n-6 )  &
             + b5_b3_d15 * f(:,:,   this%n-1) + b5_a3_d15 * f(:,:,  this%n-7 )  &
             + b5_b4_d15 * f(:,:,   this%n  ) + b5_a4_d15 * f(:,:,  this%n-8 )  &
                                              + b5_a5_d15 * f(:,:,  this%n-9 )  &
                                              + b5_a6_d15 * f(:,:,  this%n-10)  &
                                              + b5_a7_d15 * f(:,:,  this%n-11) 
        RHS(:,:,  this%n-3) = a0_d15 * ( f(:,:,  this%n-3) )                    &
             + b4_b1_d15 * f(:,:,   this%n-2) + b4_a1_d15 * f(:,:,  this%n-4 )  &
             + b4_b2_d15 * f(:,:,   this%n-1) + b4_a2_d15 * f(:,:,  this%n-5 )  &
             + b4_b3_d15 * f(:,:,   this%n  ) + b4_a3_d15 * f(:,:,  this%n-6 )  &
                                              + b4_a4_d15 * f(:,:,  this%n-7 )  &
                                              + b4_a5_d15 * f(:,:,  this%n-8 )  &
                                              + b4_a6_d15 * f(:,:,  this%n-9 )  &
                                              + b4_a7_d15 * f(:,:,  this%n-10) 
        RHS(:,:,  this%n-2) = a0_d15 * ( f(:,:,  this%n-2) )                    &
             + b3_b1_d15 * f(:,:,   this%n-1) + b3_a1_d15 * f(:,:,  this%n-3 )  &
             + b3_b2_d15 * f(:,:,   this%n  ) + b3_a2_d15 * f(:,:,  this%n-4 )  &
                                              + b3_a3_d15 * f(:,:,  this%n-5 )  &
                                              + b3_a4_d15 * f(:,:,  this%n-6 )  &
                                              + b3_a5_d15 * f(:,:,  this%n-7 )  &
                                              + b3_a6_d15 * f(:,:,  this%n-8 )  &
                                              + b3_a7_d15 * f(:,:,  this%n-9 ) 
        RHS(:,:,  this%n-1) = a0_d15 * ( f(:,:,  this%n-1) )                    &
             + b2_b1_d15 * f(:,:,   this%n  ) + b2_a1_d15 * f(:,:,  this%n-2 )  &
                                              + b2_a2_d15 * f(:,:,  this%n-3 )  &
                                              + b2_a3_d15 * f(:,:,  this%n-4 )  &
                                              + b2_a4_d15 * f(:,:,  this%n-5 )  &
                                              + b2_a5_d15 * f(:,:,  this%n-6 )  &
                                              + b2_a6_d15 * f(:,:,  this%n-7 )  &
                                              + b2_a7_d15 * f(:,:,  this%n-8 ) 
        RHS(:,:,  this%n  ) = a0_d15 * ( f(:,:,  this%n  ) )                    

     case(1)
        RHS(:,:,  this%n-6) = a0_d15 * ( f(:,:,  this%n-6) )        &
             + a1_d15 * ( f(:,:,   this%n-5) + f(:,:,  this%n-7 ) ) &
             + a2_d15 * ( f(:,:,   this%n-4) + f(:,:,  this%n-8 ) ) &
             + a3_d15 * ( f(:,:,   this%n-3) + f(:,:,  this%n-9 ) ) &
             + a4_d15 * ( f(:,:,   this%n-2) + f(:,:,  this%n-10) ) &
             + a5_d15 * ( f(:,:,   this%n-1) + f(:,:,  this%n-11) ) &
             + a6_d15 * ( f(:,:,   this%n  ) + f(:,:,  this%n-12) ) &
             + a7_d15 * ( f(:,:,   this%n-1) + f(:,:,  this%n-13) )
        RHS(:,:,  this%n-5) = a0_d15 * ( f(:,:,  this%n-5) )        &
             + a1_d15 * ( f(:,:,   this%n-4) + f(:,:,  this%n-6 ) ) &
             + a2_d15 * ( f(:,:,   this%n-3) + f(:,:,  this%n-7 ) ) &
             + a3_d15 * ( f(:,:,   this%n-2) + f(:,:,  this%n-8 ) ) &
             + a4_d15 * ( f(:,:,   this%n-1) + f(:,:,  this%n-9 ) ) &
             + a5_d15 * ( f(:,:,   this%n  ) + f(:,:,  this%n-10) ) &
             + a6_d15 * ( f(:,:,   this%n-1) + f(:,:,  this%n-11) ) &
             + a7_d15 * ( f(:,:,   this%n-2) + f(:,:,  this%n-12) )
        RHS(:,:,  this%n-4) = a0_d15 * ( f(:,:,  this%n-4) )        &
             + a1_d15 * ( f(:,:,   this%n-3) + f(:,:,  this%n-5 ) ) &
             + a2_d15 * ( f(:,:,   this%n-2) + f(:,:,  this%n-6 ) ) &
             + a3_d15 * ( f(:,:,   this%n-1) + f(:,:,  this%n-7 ) ) &
             + a4_d15 * ( f(:,:,   this%n  ) + f(:,:,  this%n-8 ) ) &
             + a5_d15 * ( f(:,:,   this%n-1) + f(:,:,  this%n-9 ) ) &
             + a6_d15 * ( f(:,:,   this%n-2) + f(:,:,  this%n-10) ) &
             + a7_d15 * ( f(:,:,   this%n-3) + f(:,:,  this%n-11) )
        RHS(:,:,  this%n-3) = a0_d15 * ( f(:,:,  this%n-3) )        &
             + a1_d15 * ( f(:,:,   this%n-2) + f(:,:,  this%n-4 ) ) &
             + a2_d15 * ( f(:,:,   this%n-1) + f(:,:,  this%n-5 ) ) &
             + a3_d15 * ( f(:,:,   this%n  ) + f(:,:,  this%n-6 ) ) &
             + a4_d15 * ( f(:,:,   this%n-1) + f(:,:,  this%n-7 ) ) &
             + a5_d15 * ( f(:,:,   this%n-2) + f(:,:,  this%n-8 ) ) &
             + a6_d15 * ( f(:,:,   this%n-3) + f(:,:,  this%n-9 ) ) &
             + a7_d15 * ( f(:,:,   this%n-4) + f(:,:,  this%n-10) )
        RHS(:,:,  this%n-2) = a0_d15 * ( f(:,:,  this%n-2) )        &
             + a1_d15 * ( f(:,:,   this%n-1) + f(:,:,  this%n-3 ) ) &
             + a2_d15 * ( f(:,:,   this%n  ) + f(:,:,  this%n-4 ) ) &
             + a3_d15 * ( f(:,:,   this%n-1) + f(:,:,  this%n-5 ) ) &
             + a4_d15 * ( f(:,:,   this%n-2) + f(:,:,  this%n-6 ) ) &
             + a5_d15 * ( f(:,:,   this%n-3) + f(:,:,  this%n-7 ) ) &
             + a6_d15 * ( f(:,:,   this%n-4) + f(:,:,  this%n-8 ) ) &
             + a7_d15 * ( f(:,:,   this%n-5) + f(:,:,  this%n-9 ) )
        RHS(:,:,  this%n-1) = a0_d15 * ( f(:,:,  this%n-1) )        &
             + a1_d15 * ( f(:,:,   this%n  ) + f(:,:,  this%n-2 ) ) &
             + a2_d15 * ( f(:,:,   this%n-1) + f(:,:,  this%n-3 ) ) &
             + a3_d15 * ( f(:,:,   this%n-2) + f(:,:,  this%n-4 ) ) &
             + a4_d15 * ( f(:,:,   this%n-3) + f(:,:,  this%n-5 ) ) &
             + a5_d15 * ( f(:,:,   this%n-4) + f(:,:,  this%n-6 ) ) &
             + a6_d15 * ( f(:,:,   this%n-5) + f(:,:,  this%n-7 ) ) &
             + a7_d15 * ( f(:,:,   this%n-6) + f(:,:,  this%n-8 ) )
        RHS(:,:,  this%n  ) = a0_d15 * ( f(:,:,  this%n  ) )        &
             + a1_d15 * ( f(:,:,   this%n-1) + f(:,:,  this%n-1 ) ) &
             + a2_d15 * ( f(:,:,   this%n-2) + f(:,:,  this%n-2 ) ) &
             + a3_d15 * ( f(:,:,   this%n-3) + f(:,:,  this%n-3 ) ) &
             + a4_d15 * ( f(:,:,   this%n-4) + f(:,:,  this%n-4 ) ) &
             + a5_d15 * ( f(:,:,   this%n-5) + f(:,:,  this%n-5 ) ) &
             + a6_d15 * ( f(:,:,   this%n-6) + f(:,:,  this%n-6 ) ) &
             + a7_d15 * ( f(:,:,   this%n-7) + f(:,:,  this%n-7 ) )

     case(-1)
        RHS(:,:,  this%n-6) = a0_d15 * ( f(:,:,  this%n-6) )        &
             + a1_d15 * ( f(:,:,   this%n-5) + f(:,:,  this%n-7 ) ) &
             + a2_d15 * ( f(:,:,   this%n-4) + f(:,:,  this%n-8 ) ) &
             + a3_d15 * ( f(:,:,   this%n-3) + f(:,:,  this%n-9 ) ) &
             + a4_d15 * ( f(:,:,   this%n-2) + f(:,:,  this%n-10) ) &
             + a5_d15 * ( f(:,:,   this%n-1) + f(:,:,  this%n-11) ) &
             + a6_d15 * ( f(:,:,   this%n  ) + f(:,:,  this%n-12) ) &
             + a7_d15 * (-f(:,:,   this%n-1) + f(:,:,  this%n-13) )
        RHS(:,:,  this%n-5) = a0_d15 * ( f(:,:,  this%n-5) )        &
             + a1_d15 * ( f(:,:,   this%n-4) + f(:,:,  this%n-6 ) ) &
             + a2_d15 * ( f(:,:,   this%n-3) + f(:,:,  this%n-7 ) ) &
             + a3_d15 * ( f(:,:,   this%n-2) + f(:,:,  this%n-8 ) ) &
             + a4_d15 * ( f(:,:,   this%n-1) + f(:,:,  this%n-9 ) ) &
             + a5_d15 * ( f(:,:,   this%n  ) + f(:,:,  this%n-10) ) &
             + a6_d15 * (-f(:,:,   this%n-1) + f(:,:,  this%n-11) ) &
             + a7_d15 * (-f(:,:,   this%n-2) + f(:,:,  this%n-12) )
        RHS(:,:,  this%n-4) = a0_d15 * ( f(:,:,  this%n-4) )        &
             + a1_d15 * ( f(:,:,   this%n-3) + f(:,:,  this%n-5 ) ) &
             + a2_d15 * ( f(:,:,   this%n-2) + f(:,:,  this%n-6 ) ) &
             + a3_d15 * ( f(:,:,   this%n-1) + f(:,:,  this%n-7 ) ) &
             + a4_d15 * ( f(:,:,   this%n  ) + f(:,:,  this%n-8 ) ) &
             + a5_d15 * (-f(:,:,   this%n-1) + f(:,:,  this%n-9 ) ) &
             + a6_d15 * (-f(:,:,   this%n-2) + f(:,:,  this%n-10) ) &
             + a7_d15 * (-f(:,:,   this%n-3) + f(:,:,  this%n-11) )
        RHS(:,:,  this%n-3) = a0_d15 * ( f(:,:,  this%n-3) )        &
             + a1_d15 * ( f(:,:,   this%n-2) + f(:,:,  this%n-4 ) ) &
             + a2_d15 * ( f(:,:,   this%n-1) + f(:,:,  this%n-5 ) ) &
             + a3_d15 * ( f(:,:,   this%n  ) + f(:,:,  this%n-6 ) ) &
             + a4_d15 * (-f(:,:,   this%n-1) + f(:,:,  this%n-7 ) ) &
             + a5_d15 * (-f(:,:,   this%n-2) + f(:,:,  this%n-8 ) ) &
             + a6_d15 * (-f(:,:,   this%n-3) + f(:,:,  this%n-9 ) ) &
             + a7_d15 * (-f(:,:,   this%n-4) + f(:,:,  this%n-10) )
        RHS(:,:,  this%n-2) = a0_d15 * ( f(:,:,  this%n-2) )        &
             + a1_d15 * ( f(:,:,   this%n-1) + f(:,:,  this%n-3 ) ) &
             + a2_d15 * ( f(:,:,   this%n  ) + f(:,:,  this%n-4 ) ) &
             + a3_d15 * (-f(:,:,   this%n-1) + f(:,:,  this%n-5 ) ) &
             + a4_d15 * (-f(:,:,   this%n-2) + f(:,:,  this%n-6 ) ) &
             + a5_d15 * (-f(:,:,   this%n-3) + f(:,:,  this%n-7 ) ) &
             + a6_d15 * (-f(:,:,   this%n-4) + f(:,:,  this%n-8 ) ) &
             + a7_d15 * (-f(:,:,   this%n-5) + f(:,:,  this%n-9 ) )
        RHS(:,:,  this%n-1) = a0_d15 * ( f(:,:,  this%n-1) )        &
             + a1_d15 * ( f(:,:,   this%n  ) + f(:,:,  this%n-2 ) ) &
             + a2_d15 * (-f(:,:,   this%n-1) + f(:,:,  this%n-3 ) ) &
             + a3_d15 * (-f(:,:,   this%n-2) + f(:,:,  this%n-4 ) ) &
             + a4_d15 * (-f(:,:,   this%n-3) + f(:,:,  this%n-5 ) ) &
             + a5_d15 * (-f(:,:,   this%n-4) + f(:,:,  this%n-6 ) ) &
             + a6_d15 * (-f(:,:,   this%n-5) + f(:,:,  this%n-7 ) ) &
             + a7_d15 * (-f(:,:,   this%n-6) + f(:,:,  this%n-8 ) )
        RHS(:,:,  this%n  ) = a0_d15 * ( f(:,:,  this%n  ) )        &
             + a1_d15 * (-f(:,:,   this%n-1) + f(:,:,  this%n-1 ) ) &
             + a2_d15 * (-f(:,:,   this%n-2) + f(:,:,  this%n-2 ) ) &
             + a3_d15 * (-f(:,:,   this%n-3) + f(:,:,  this%n-3 ) ) &
             + a4_d15 * (-f(:,:,   this%n-4) + f(:,:,  this%n-4 ) ) &
             + a5_d15 * (-f(:,:,   this%n-5) + f(:,:,  this%n-5 ) ) &
             + a6_d15 * (-f(:,:,   this%n-6) + f(:,:,  this%n-6 ) ) &
             + a7_d15 * (-f(:,:,   this%n-7) + f(:,:,  this%n-7 ) )

     end select
  end select
